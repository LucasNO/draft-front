<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Posição</title>

    <link rel="stylesheet" href="../css/bootstrap.min.css">

  </head>

  <body onload="listPosicoes();">
      <div class="container">
        <form id='posicaoForm'>
          <div class="form-group"><input id="id" type='number' name='ID' hidden /></div>
          <div class="form-group"><input id="posicao" type='text' name='Posição' placeholder='Nome da Posição' /></div>
          <div class="form-group"><input type='submit' onclick="savePosicao();" value='Salvar' /></div>
        </form>
        <!-- <div id='response'></div> -->
        <table id="posicoes" class="table" cellspacing="0" width="100%" >
            <thead class="thead-dark">
                <tr>
                    <th data-field="descricao">Posição</th>
                </tr>
            </thead>
        </table>
      </div><!--// .container -->

      <script src="../js/jquery-3.3.1.min.js"></script>
      <script src="../js/popper.min.js"></script>
      <script src="../js/bootstrap.min.js"></script>
      <script>
      function savePosicao() {
        var posicao = document.getElementById('posicao').value;
        var dado = {descricao:posicao};
        var parametros = JSON.stringify(dado);
        $.ajax({
            type: 'POST',
            url: 'https://draft-webservice.herokuapp.com/draft/posicao',
            contentType: "application/json",
            data: parametros,
            dataType: "text",
            success: function( data, textStatus, jQxhr ){
              console.log(textStatus);
            },
            error: function( jqXhr, textStatus, errorThrown ){
                console.log( errorThrown );
            }
          }); //ajax
        }

      function listPosicoes() {
        console.log("Passou Aqui!!!");
          $.ajax({
              type: 'GET',
              url: "https://draft-webservice.herokuapp.com/draft/posicoes",
              dataType: 'json',
              contentType: 'application/json',
              success: function (data, textStatus, xhr) {
                  $.each(data,function(i,item){
                    $("#posicoes").append(
                      "<tr>"
                      +"<td>"+item.descricao+"</td>"
                      +"</tr>" )
                  })
              },
              error: function (xhr, status, error) {
                  console.log("error: " + xhr.status);
              }
          }); //ajax
        }
      </script>
  </body>
</html>
